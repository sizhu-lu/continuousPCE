% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/copula_utils.R
\name{copula_function_vectorized}
\alias{copula_function_vectorized}
\title{Copula Function with Vectorization Support}
\usage{
copula_function_vectorized(
  U,
  V,
  expansion_type = "both",
  copula_type = "independent",
  rho = 0
)
}
\arguments{
\item{U}{A numeric vector or matrix representing the first set of uniform
random variables. If expansion type is 'U' or 'both', `U` is replicated
along the second dimension.}

\item{V}{A numeric vector or matrix representing the second set of uniform
random variables. If expansion type is 'V' or 'both', `V` is replicated
along the first dimension.}

\item{expansion_type}{A character string indicating how to expand the copula
inputs. Can be one of:
     - "U": Only the `U` vector is expanded (i.e., `U` is broadcasted to match `V`).
     - "V": Only the `V` vector is expanded (i.e., `V` is broadcasted to match `U`).
     - "both": Both `U` and `V` are expanded to create a grid of copula evaluations.
Default is "both".}

\item{copula_type}{A character string specifying the type of copula to
compute. Can be one of:
     - "independent": Assumes no dependence between `U` and `V`, returning 1 for all pairs.
     - "gaussian": Computes the Gaussian copula, which models correlation between `U` and `V`.
     - "fgm": Computes the Farlie-Gumbel-Morgenstern copula, another model for correlation between `U` and `V`.
Default is "independent".}

\item{rho}{A numeric scalar between -1 and 1, representing the correlation
parameter used in the Gaussian and FGM copulas. Default is 0, indicating no
correlation.}
}
\value{
A numeric matrix or array of copula values. The dimensions of the
  return value depend on the `expansion_type`.
\itemize{
  \item If `expansion_type` is "U", the output will have dimensions (\eqn{n_v}, n).
  \item If "V", the output will have dimensions (\eqn{n_u}, n).
  \item If "both", the output will have dimensions (\eqn{n_u}, \eqn{n_v}, n).
}
}
\description{
This function computes copula values for pairs of uniform random variables
using a specified copula type and expansion method. The function supports
vectorized operations for efficient computation of copula values for multiple
inputs at once. It can handle the 'independent', 'Gaussian', and
'Farlie-Gumbel-Morgenstern (FGM)' copulas. The expansion type determines how
the copula is applied to the input arrays.
}
\details{
The function computes the copula values for pairs of uniform random
  variables `U` and `V`. It supports three types of copulas:

\itemize{
  \item Independent copula: The copula value is always 1, representing no dependence between `U` and `V`.
  \item Gaussian copula: The copula value models correlation between `U` and `V`, with correlation parameter `rho`.
  \item FGM copula: The copula value is computed using the Farlie-Gumbel-Morgenstern copula formula with correlation `rho`.
}

  The function also allows for different methods of expanding `U` and `V` to
  create grids of copula evaluations, making it flexible for different data
  structures.
}
\examples{
# Example: Compute Gaussian copula with correlation 0.5
U <- matrix(1:6, nrow = 2, ncol = 3)
V <- matrix(7:18, nrow = 4, ncol = 3)
copula_vals <- copula_function_vectorized(U, V, expansion_type = "both",
copula_type = "gaussian", rho = 0.5)

# Example: Compute independent copula
copula_vals_independent <- copula_function_vectorized(U, V,
expansion_type = "both", copula_type = "independent")

}
